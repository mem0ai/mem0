services:
  qdrant:
    image: qdrant/qdrant:latest
    container_name: openmemory-qdrant
    ports:
      - "6333:6333"
    volumes:
      - openmemory:/qdrant/storage
    restart: always

  openmemory-mcp:
    build:
      context: ./api
      dockerfile: Dockerfile
    container_name: openmemory-mcp
    depends_on:
      - qdrant
    ports:
      - "10003:8765"
    env_file:
      - ./api/.env
    volumes:
      - openmemory:/data
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: always

  openmemory-ui:
    build:
      context: ./ui
      dockerfile: Dockerfile
    container_name: openmemory-ui
    ports:
      - "10004:3000"
    env_file:
      - ./ui/.env
    depends_on:
      - openmemory-mcp
    restart: always

volumes:
  openmemory:
    name: openmemory
